---
layout: post
title:  베이즈 확률
date:   2021-06-17 19:00:00 +0900
description: 베이즈 확률이란 무엇인가?
categories: math
---

빈도주의 개념에서 확률은 경우의 수를 통해 정의됩니다. 예를 들어 동전을 100번 던졌을 때, 앞면은 53번, 뒷면은 47번이 나왔다면 앞면이 나올 확률은 $$ \frac{53}{100} $$, 뒷면이 나올 확률은 $$ \frac{47}{100} $$인 셈입니다. 이를 무한대로 근사한다면 앞면과 뒷면이 나올 확률이 모두 $$ \frac{1}{2} $$라고 생각할 수 있습니다.

반면에 베이지안 개념에서는 불확실성을 정량적으로 표현하여 확률을 정의합니다. 사건이 반복가능하지 않은 경우, 예를 들어 북극얼음이 녹아 없어질 확률과 같은 경우 이미 알고 있는 정보를 근거해 확률을 표현하는 방법입니다.

**베이즈 확률(Bayes Theorem)**이란 사후확률을 사전확률과 우도를 통해 구하는 방식입니다. 베이즈 확률은 사후확률을 직접 구하는 것이 쉽지 않을때 이를 사전확률과 우도를 통해 구하기 위해 유용하게 사용됩니다.

일반적으로 확률변수 $$ X, Y $$에서는 다음과 같은 법칙이 만족합니다.

$$ p(X) = \sum_Y{p(X, Y)} $$

$$ p(X, Y) = p(X|Y)p(Y) = p(Y|X)p(X) $$

위의 식을 덧셈법칙(sum rule)이라 하고, 아래 식을 곱셈법칙(product rule)이라고 합니다. 이를 정리하면 다음과 같은 식을 얻을 수 있습니다.

$$ p(Y|X) = \frac{p(X|Y)p(Y)}{\sum_Y{p(X|Y)p(Y)}} $$

여기서 $$ p(Y\vert X) $$는 사후확률(posterior)이 되고, $$ p(X\vert Y) $$는 우도(likelihood), $$ p(Y) $$는 사전확률(prior)이 됩니다. 또 $$ \sum_Y{p(X\vert Y)p(Y)} $$는 $$ p(X) $$와 같은 값이며, $$ X $$ 의 경계확률(marginal)을 말합니다.

$$ posterior = \frac{likelihood * prior}{marginal} $$

**사전확률(prior)** $$p(Y)$$는 우리가 이미 알고있는 지식을 말합니다.

**우도(likelihood)** $$p(X\vert Y)$$는 새로운 데이터를 관찰하고 난 뒤의 조건부확률을 말합니다. 즉 특정 $$Y$$값에 대해 $$X$$의 관찰값의 가능성을 나타냅니다.

**사후확률** $$p(Y\vert X)$$은 $$X$$를 관찰하고 난 후 $$Y$$에 대한 불확실성을 표현하는 확률입니다.

빈도주의 관점에서는 $$X$$를 고정시킨 후, 최대우도와 같은 추정자(estimator)를 사용해서 그 값을 구하게 됩니다. 즉 부투스트랩(bootstrap) 등의 방법을 통해 데이터들로부터 $$Y$$를 뽑으면서 빈도를 관찰하게 됩니다. 이 경우, 동전을 던져서 세 번다 앞면이 나왔을 때 최대우도에 의해 앞면이 나올 확률은 1이 됩니다.

반면에 베이지안 관점에서는 사전확률을 모델에 포함시킬 수 있습니다. 이 경우 동전을 던져서 계속 앞면이 나오더라도 극단적인 값을 피할 수 있게 됩니다.
